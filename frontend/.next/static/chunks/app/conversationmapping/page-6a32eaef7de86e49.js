(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[235],{7208:function(e,s,a){Promise.resolve().then(a.bind(a,3262))},9298:function(e,s,a){"use strict";a.d(s,{Z:function(){return c}});var n=a(7437),t=a(2265),o=a(6648),r=a(9714),i=a(8472);a(712),a(4193);var l=e=>{let{event:s,is_read:a,event_id:o,handleMarkAsRead:r}=e,[i,l]=(0,t.useState)(!1);return(0,n.jsx)("li",{className:a?"":"new-notification",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{children:(0,n.jsx)("i",{className:"bi bi-chat-right-text icon-message icon-missed"})}),(0,n.jsx)("span",{className:"missed-message",children:"You have missed message from"}),(0,n.jsx)("div",{className:"event-from",children:s.from}),(0,n.jsxs)("div",{className:"message-body",children:["Message:",i||!s.body||s.body.length<=18?s.body||"No content available":"".concat(s.body.slice(0,18),".. "),s.body&&s.body.length>18&&(0,n.jsx)("button",{onClick:()=>{l(!i)},className:"read-more-btn text-success",children:i?"..Read Less":"Read More"}),(0,n.jsx)("div",{children:!a&&(0,n.jsx)("button",{onClick:()=>r(o),className:"notification-info",children:"Mark as Read"})})]})]})},o)},c=e=>{let{toggleSidebar:s,setResults:a,onSelectAddress:c}=e,[d,h]=(0,t.useState)(""),[p,u]=(0,t.useState)(""),[m,x]=(0,t.useState)([]),[g,j]=(0,t.useState)([]),[v,f]=(0,t.useState)(!1);(0,t.useEffect)(()=>{let e=localStorage.getItem("authToken");if(e)try{let s=(0,r.o)(e);h(s.name)}catch(e){console.error("Failed to decode token:",e)}},[]),(0,t.useEffect)(()=>{(async()=>{try{let e=await i.Z.get("http://localhost:8000/notifications");j(e.data.filter(e=>!e.is_read))}catch(e){console.error("Error fetching notifications:",e),j([])}})()},[]);let _=async e=>{try{let s=await i.Z.post("http://localhost:8000/notifications/".concat(e,"/read"));console.log("Backend Response:",s),200===s.status||201===s.status?j(s=>s.filter(s=>s.event_id!==e)):console.error("Failed to mark notification as read:",s)}catch(e){console.error("Error marking notification as read:",e)}},b=g.length;return(0,n.jsx)("nav",{className:"navbar",children:(0,n.jsxs)("div",{className:"container-fluid",children:[(0,n.jsx)(o.default,{src:"/line.svg",alt:"Logo",className:"logo1",width:50,height:50,onClick:s}),(0,n.jsxs)("div",{className:"nav-list",children:[(0,n.jsx)("div",{className:"profileicon",children:(0,n.jsx)(o.default,{src:"/account_circle.svg",alt:"Profile",className:"profile",width:50,height:50})}),(0,n.jsx)("a",{className:"name",children:d||"User"}),(0,n.jsxs)("div",{className:"bellicon",onClick:()=>{f(!v)},children:[(0,n.jsx)(o.default,{src:"/bell.svg",alt:"Notifications",className:"bell",width:50,height:50}),b>0&&(0,n.jsx)("span",{className:"new-notification-dot",children:b})]}),v&&(0,n.jsxs)("div",{className:"notification-dropdown",children:[(0,n.jsxs)("div",{className:"main-notification",children:[(0,n.jsxs)("span",{children:[(0,n.jsx)("i",{className:"bi bi-telephone-inbound-fill call-icon"})," Calls"]}),(0,n.jsxs)("span",{className:"text-danger",children:[" ",(0,n.jsx)("i",{className:"bi bi-chat-right-text icon-message"})," Message "]})]}),(0,n.jsx)("div",{className:"border-bottom mt-2"}),(0,n.jsx)("ul",{children:g.map(e=>(0,n.jsx)(l,{event:e.event,is_read:e.is_read,event_id:e.event_id,handleMarkAsRead:_,id:0,address_id:null,created_at:""},e.event_id))})]})]})]})})}},553:function(e,s,a){"use strict";var n=a(7437);a(2265);var t=a(6648),o=a(7138),r=a(6463);a(4307),a(9252),s.Z=()=>{let e=(0,r.useRouter)();return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("ul",{className:"sidebar",children:[(0,n.jsx)("div",{children:(0,n.jsxs)("li",{className:"nav",children:[(0,n.jsxs)(o.default,{href:"/Dashboard",children:[(0,n.jsx)(t.default,{src:"/upicon.svg",alt:"Logo",className:"logo2",width:50,height:50}),(0,n.jsx)("p",{className:"dash",children:"Dashboard"})]})," "]})}),(0,n.jsx)("div",{children:(0,n.jsx)("li",{className:"nav",children:(0,n.jsxs)(o.default,{href:"/conversationmapping",children:[(0,n.jsx)(t.default,{src:"/mapingi.svg",alt:"Logo",className:"logo2",width:50,height:50}),(0,n.jsx)("p",{className:"dash",children:"Map Address"})]})})}),(0,n.jsx)("div",{className:"log",children:(0,n.jsx)("div",{onClick:()=>{localStorage.removeItem("authToken"),e.push("/")},children:"Log out"})})]})})}},3262:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return b}});var n=a(7437),t=a(2265),o=a(2824),r=a(9811),i=a(8472),l=a(8998),c=a.n(l),d=a(2962),h=a(3830),p=a(4746),u=a(7622),m=a.n(u),x=a(3580);a(4193);var g=e=>{let{show:s,onHide:a,conversationId:o,onSaveSuccess:r}=e,[l,c]=(0,t.useState)([]),[u,g]=(0,t.useState)([]),[j,v]=(0,t.useState)(""),[f,_]=(0,t.useState)(""),[b,N]=(0,t.useState)(!1),w=(0,t.useRef)(null);(0,t.useEffect)(()=>{(async()=>{try{let e=await i.Z.get("http://localhost:8000/address/getalladdress");if(console.log("API response:",e.data),Array.isArray(e.data)){let s=e.data.map(e=>e.address);c(s),g(s)}else console.error("Unexpected API response format:",e.data)}catch(e){console.error("Error fetching addresses:",e)}})()},[]),(0,t.useEffect)(()=>{g(l.filter(e=>e.toLowerCase().includes(f.toLowerCase())))},[f,l]);let y=async()=>{if(console.log("Save button clicked"),!j){x.Am.error("Please select an address before saving.");return}try{await i.Z.post("http://localhost:8000/conversation-mapping/map",{conversationId:o,address:j}),x.Am.success("Saved successfully!"),setTimeout(()=>{a(),r()},2e3)}catch(e){console.error("Error saving data:",e),x.Am.error("Failed to save data.")}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(d.Z,{show:s,onHide:a,centered:!0,children:[(0,n.jsx)(d.Z.Header,{closeButton:!0,children:(0,n.jsx)(d.Z.Title,{children:"Select Address"})}),(0,n.jsx)(d.Z.Body,{children:(0,n.jsxs)("div",{className:m().dropdownContainer,children:[(0,n.jsxs)("button",{ref:w,className:"".concat(m().dropdownButton," ").concat(m().dropdownToggle),onClick:()=>{N(e=>!e)},children:[j||"Search Address",(0,n.jsx)("span",{className:"".concat(m().dropdownIcon," ").concat(b?m().open:""),children:"â–¼"})]}),b&&(0,n.jsxs)("div",{className:m().dropdownMenu,children:[(0,n.jsx)(h.Z.Control,{type:"text",placeholder:"Search Address",value:f,onChange:e=>_(e.target.value),className:m().searchInput}),u.length>0?u.map((e,s)=>(0,n.jsx)("div",{className:m().dropdownItem,onClick:()=>{v(e),_(""),N(!1)},children:e},s)):(0,n.jsx)("div",{className:m().dropdownItem,style:{cursor:"not-allowed"},children:"No addresses found"})]})]})}),(0,n.jsxs)(d.Z.Footer,{children:[(0,n.jsx)(p.Z,{variant:"primary",onClick:y,children:"Save"}),(0,n.jsx)(p.Z,{variant:"secondary",onClick:a,children:"Close"})]})]}),(0,n.jsx)(x.Ix,{})]})},j=a(7257),v=a.n(j),f=a(553),_=a(9298),b=()=>{let[e,s]=(0,t.useState)([]),[a,l]=(0,t.useState)(!1),[d,h]=(0,t.useState)(null),[p,u]=(0,t.useState)("Search Address"),[m,x]=(0,t.useState)(0),[j,b]=(0,t.useState)(!0),N=async()=>{try{let e=await i.Z.get("http://localhost:8000/openPhoneEventData/getConversationsWithoutAddress");console.log("API response:",e);let a=e.data.data;console.log("Data:",a),Array.isArray(a)?s(a):console.error("API response is not an array:",a)}catch(e){console.error("Error fetching data:",e)}};(0,t.useEffect)(()=>{N()},[]);let w=e=>{h(e),l(!0)},y=5*m,C=e.slice(y,y+5),S=Math.ceil(e.length/5);return(0,n.jsxs)("div",{children:[(0,n.jsx)(_.Z,{toggleSidebar:()=>{b(e=>!e)},onSelectAddress:e=>{u(e.fullAddress)}}),j&&(0,n.jsx)(f.Z,{}),(0,n.jsx)("div",{className:"styles.mainContainer ".concat(j?"sidebar-visible":""),children:(0,n.jsxs)(o.Z,{className:v().container,children:[(0,n.jsx)("h2",{className:v().tableHeading,children:"Conversation Mapping"}),(0,n.jsxs)(r.Z,{bordered:!0,hover:!0,className:v().conversationTable,children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Conversation ID"}),(0,n.jsx)("th",{children:"From Number"}),(0,n.jsx)("th",{children:"To Number"}),(0,n.jsx)("th",{children:"Messages"})]})}),(0,n.jsx)("tbody",{children:C.length>0?C.map((e,s)=>(0,n.jsxs)("tr",{onClick:()=>w(e),children:[(0,n.jsx)("td",{children:e.conversation_id}),(0,n.jsx)("td",{children:e.from}),(0,n.jsx)("td",{children:e.to}),(0,n.jsx)("td",{children:e.body})]},s)):(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:4,children:"No records found"})})})]}),(0,n.jsx)(c(),{previousLabel:"<",nextLabel:">",breakLabel:"...",pageCount:S,marginPagesDisplayed:2,pageRangeDisplayed:3,onPageChange:e=>{x(e.selected)},containerClassName:v().pagination,activeClassName:v().active}),d&&(0,n.jsx)(g,{show:a,onHide:()=>{l(!1),h(null)},conversationId:d.conversation_id,onSaveSuccess:N})]})})]})}},712:function(){},4307:function(){},7257:function(e){e.exports={mainContainer:"page_mainContainer__kPlQ6","sidebar-visible":"page_sidebar-visible__hN0Iz",container:"page_container__KUYkv",tableHeading:"page_tableHeading__TgCFO",conversationTable:"page_conversationTable__ZUFLM",pagination:"page_pagination__IIBr3",active:"page_active__g1x__"}},7622:function(e){e.exports={dropdownContainer:"popup_dropdownContainer__1bqCx",dropdownButton:"popup_dropdownButton__UZWmk",dropdownIcon:"popup_dropdownIcon__yFWsq",open:"popup_open__0nqWe",dropdownMenu:"popup_dropdownMenu__JATfe",searchInput:"popup_searchInput__w7BkJ",dropdownItem:"popup_dropdownItem__btz6e","modal-body":"popup_modal-body__c2Vw9","modal-content":"popup_modal-content__OXXRz","modal-header":"popup_modal-header__UHEZH","modal-footer":"popup_modal-footer___jYPU"}}},function(e){e.O(0,[622,51,279,776,197,873,971,23,744],function(){return e(e.s=7208)}),_N_E=e.O()}]);